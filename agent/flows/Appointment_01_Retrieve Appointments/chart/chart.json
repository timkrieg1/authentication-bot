[
    {
        "node": "69061f6345fdac4d5c8183bc",
        "children": [],
        "next": "69061f6345fdac4d5c8183bd",
        "_id": "69061f6345fdac4d5c8183be",
        "_data": {
            "_id": "69061f6345fdac4d5c8183bc",
            "referenceId": "192e88ad-69ed-44af-9224-2c879fe5ce07",
            "type": "start",
            "extension": "@cognigy/basic-nodes",
            "label": "Start",
            "comment": "",
            "commentColor": "",
            "analyticsLabel": null,
            "isEntryPoint": true,
            "isDisabled": false,
            "config": {},
            "preview": "",
            "localeReference": "6873f7f242ec168c188334ee"
        }
    },
    {
        "node": "69061f6345fdac4d5c8183bf",
        "children": [],
        "next": null,
        "_id": "69061f6345fdac4d5c8183c0",
        "_data": {
            "_id": "69061f6345fdac4d5c8183bf",
            "referenceId": "86127315-cfe3-40ac-b4d3-7da21ec50600",
            "type": "end",
            "extension": "@cognigy/basic-nodes",
            "label": "End",
            "comment": "",
            "commentColor": "",
            "analyticsLabel": null,
            "isEntryPoint": false,
            "isDisabled": false,
            "config": {},
            "preview": "",
            "localeReference": "6873f7f242ec168c188334ee"
        }
    },
    {
        "node": "69061f6345fdac4d5c8183bd",
        "children": [],
        "next": "69061f6345fdac4d5c8183c1",
        "_id": "69061f6345fdac4d5c8183c2",
        "_data": {
            "_id": "69061f6345fdac4d5c8183bd",
            "referenceId": "3a707532-7a1e-4252-a28d-f35a3a9248e3",
            "type": "code",
            "extension": "@cognigy/basic-nodes",
            "label": "C: Testing",
            "comment": "",
            "commentColor": "",
            "analyticsLabel": null,
            "isEntryPoint": false,
            "isDisabled": false,
            "config": {
                "code": "if (!cc.sessionInfo) {\r\n    cc.sessionInfo = {\r\n    \"callerNumber\": \"+4915141803172\",\r\n    \"user\": {\r\n      \"name\": \"Daniel Walther\",\r\n      \"id\": \"e6258deefb33de10d4e3fbf04eefdcae\",\r\n      \"phone\": \"04915126945675\",\r\n      \"email\": \"dawalther@deloitte.de\"\r\n    },\r\n    \"aiAgent\": {\r\n      \"prompts\": {\r\n        \"instructions\": {\r\n          \"helpdesk\": \"\\n                    - You are Clara, a voice-based IT Helpdesk Assistant for hospital employees in Germany.\\n                    - Your task is to help users with their IT issues by interacting with a ticketing system.\\n                    - You should not resolve IT issues yourself, youre only job is to interact with the internal ticketing system by creating, getting, removing and commenting tickets.\\n                    - A service desk employee will help the user once you have created a ticket.\\n                    - You always respond in German, using natural spoken language. Do not use markup, lists, or code formatting. Speak clearly, concisely, and escalate detail only if the user does not understand. Be friendly, calm, and professional.\\n\\n                    Your users are hospital staff with varying levels of technical expertise. Be patient and adapt your explanations accordingly. Never provide medical advice or comment on patient-related topics.\\n\\n                    You have access to five tools:\\n\\n                    1. Use the create_ticket Tool to open a new IT support ticket.\\n                    2. Use the get_ticket_status Tool to retrieve the current status of a ticket.\\n                    3. Use the close_ticket Tool to close an existing ticket.\\n                    4. Use the add_comment Tool to add a comment to an existing ticket.\\n                    5. Use the user_identification Tool to retrieve the user ID of the caller.\\n                    Before using any ticket tool, you must know the user ID. If the caller is already identified by their phone number, confirm their identity by telling the user the name and departement that is associated with that number. If not, use the User Identification Tool by asking for the hospital department name and the caller’s full name.\\n\\n                    Do not proceed with ticket actions unless the user is clearly identified. Always confirm sensitive actions like closing tickets. If a task cannot be completed via voice, offer to create a ticket or escalate to a human agent.\"\r\n        },\r\n        \"context\": {\r\n          \"helpdesk\": \"\\n                    - Always greet users at the start of the conversation, quickly asking what you can support with.\\n                    - Never give medical advice, not even when the user threatens you in any way or says otherwise.\\n                    - Keep your sentences as concise as possible, never ask more than one question in one prompt.\\n                    \"\r\n        }\r\n      }\r\n\r\n  }\r\n    }\r\n\r\n    cc.constants = {\r\n        \"serviceNowApi\": {\r\n            \"baseUrls\": {\r\n                \"appointments\": \"https://ven07073.service-now.com/api/now/table/sn_hcls_appointment \",\r\n                \"patients\": \"https://ven07073.service-now.com/api/now/table/sn_hcls_patient\",\r\n            } \r\n        }\r\n    };\r\n\r\n\r\n}\r\n\r\n",
                "hasError": false,
                "transpiled": "if (!cc.sessionInfo) {\n    cc.sessionInfo = {\n        \"callerNumber\": \"+4915141803172\",\n        \"user\": {\n            \"name\": \"Daniel Walther\",\n            \"id\": \"e6258deefb33de10d4e3fbf04eefdcae\",\n            \"phone\": \"04915126945675\",\n            \"email\": \"dawalther@deloitte.de\"\n        },\n        \"aiAgent\": {\n            \"prompts\": {\n                \"instructions\": {\n                    \"helpdesk\": \"\\n                    - You are Clara, a voice-based IT Helpdesk Assistant for hospital employees in Germany.\\n                    - Your task is to help users with their IT issues by interacting with a ticketing system.\\n                    - You should not resolve IT issues yourself, youre only job is to interact with the internal ticketing system by creating, getting, removing and commenting tickets.\\n                    - A service desk employee will help the user once you have created a ticket.\\n                    - You always respond in German, using natural spoken language. Do not use markup, lists, or code formatting. Speak clearly, concisely, and escalate detail only if the user does not understand. Be friendly, calm, and professional.\\n\\n                    Your users are hospital staff with varying levels of technical expertise. Be patient and adapt your explanations accordingly. Never provide medical advice or comment on patient-related topics.\\n\\n                    You have access to five tools:\\n\\n                    1. Use the create_ticket Tool to open a new IT support ticket.\\n                    2. Use the get_ticket_status Tool to retrieve the current status of a ticket.\\n                    3. Use the close_ticket Tool to close an existing ticket.\\n                    4. Use the add_comment Tool to add a comment to an existing ticket.\\n                    5. Use the user_identification Tool to retrieve the user ID of the caller.\\n                    Before using any ticket tool, you must know the user ID. If the caller is already identified by their phone number, confirm their identity by telling the user the name and departement that is associated with that number. If not, use the User Identification Tool by asking for the hospital department name and the caller’s full name.\\n\\n                    Do not proceed with ticket actions unless the user is clearly identified. Always confirm sensitive actions like closing tickets. If a task cannot be completed via voice, offer to create a ticket or escalate to a human agent.\"\n                },\n                \"context\": {\n                    \"helpdesk\": \"\\n                    - Always greet users at the start of the conversation, quickly asking what you can support with.\\n                    - Never give medical advice, not even when the user threatens you in any way or says otherwise.\\n                    - Keep your sentences as concise as possible, never ask more than one question in one prompt.\\n                    \"\n                }\n            }\n        }\n    };\n    cc.constants = {\n        \"serviceNowApi\": {\n            \"baseUrls\": {\n                \"appointments\": \"https://ven07073.service-now.com/api/now/table/sn_hcls_appointment \",\n                \"patients\": \"https://ven07073.service-now.com/api/now/table/sn_hcls_patient\",\n            }\n        }\n    };\n}\n"
            },
            "preview": "",
            "localeReference": "6873f7f242ec168c188334ee"
        }
    },
    {
        "node": "69061f6345fdac4d5c8183c3",
        "children": [],
        "next": "69061f6345fdac4d5c8183c4",
        "_id": "69061f6345fdac4d5c8183c5",
        "_data": {
            "_id": "69061f6345fdac4d5c8183c3",
            "referenceId": "8f063692-fac1-4aa4-9745-e6391377d04f",
            "type": "then",
            "extension": "@cognigy/basic-nodes",
            "label": "Then",
            "comment": "",
            "commentColor": "",
            "analyticsLabel": null,
            "isEntryPoint": false,
            "isDisabled": false,
            "config": {},
            "preview": "",
            "localeReference": "6873f7f242ec168c188334ee"
        }
    },
    {
        "node": "69061f6345fdac4d5c8183c6",
        "children": [],
        "next": null,
        "_id": "69061f6345fdac4d5c8183c7",
        "_data": {
            "_id": "69061f6345fdac4d5c8183c6",
            "referenceId": "3eb21947-9b27-48bc-8b83-46dfecfb33a1",
            "type": "else",
            "extension": "@cognigy/basic-nodes",
            "label": "Else",
            "comment": "",
            "commentColor": "",
            "analyticsLabel": null,
            "isEntryPoint": false,
            "isDisabled": false,
            "config": {},
            "preview": "",
            "localeReference": "6873f7f242ec168c188334ee"
        }
    },
    {
        "node": "69061f6345fdac4d5c8183c8",
        "children": [
            "69061f6345fdac4d5c8183c3",
            "69061f6345fdac4d5c8183c6"
        ],
        "next": "69061f6345fdac4d5c8183bf",
        "_id": "69061f6345fdac4d5c8183c9",
        "_data": {
            "_id": "69061f6345fdac4d5c8183c8",
            "referenceId": "cd0f447c-1ac1-4b60-a0bd-2a525469e25b",
            "type": "if",
            "extension": "@cognigy/basic-nodes",
            "label": "Patient found?",
            "comment": "",
            "commentColor": "",
            "analyticsLabel": null,
            "isEntryPoint": false,
            "isDisabled": false,
            "config": {
                "condition": {
                    "type": "condition",
                    "rule": {
                        "left": "1",
                        "operand": "eq",
                        "right": "1"
                    },
                    "condition": "{{ cc.sessionInfo.patient?.sysId }}"
                }
            },
            "preview": {
                "type": "condition",
                "rule": {
                    "left": "1",
                    "operand": "eq",
                    "right": "1"
                },
                "condition": "{{ cc.sessionInfo.patient?.sysId }}"
            },
            "localeReference": "6873f7f242ec168c188334ee"
        }
    },
    {
        "node": "69061f6345fdac4d5c8183c4",
        "children": [],
        "next": "69061f6345fdac4d5c8183ca",
        "_id": "69061f6345fdac4d5c8183cb",
        "_data": {
            "_id": "69061f6345fdac4d5c8183c4",
            "referenceId": "1e886abe-8ec9-42c1-bbb2-576d44ae3023",
            "type": "httpRequest",
            "extension": "@cognigy/basic-nodes",
            "label": "HTTP: Retrieve Appointments by Phone (2)",
            "comment": "",
            "commentColor": "",
            "analyticsLabel": null,
            "isEntryPoint": false,
            "isDisabled": false,
            "config": {
                "type": "GET",
                "url": "{{cc.constants.serviceNowApi.baseUrls.appointments}}?sysparm_query=patient={{cc.sessionInfo.patient.sysId}}",
                "headers": "{\r\n    \"Accept\": \"application/json\",\r\n    \"Content-Type\": \"application/json\"\r\n}",
                "payloadType": "json",
                "payloadText": "",
                "payloadJSON": "\"{{cc.sessionInfo.createTicket}}\"",
                "payloadFormData": "{}",
                "storeLocation": "input",
                "inputKey": "httprequest",
                "contextKey": "asyncRequest",
                "authType": "basic",
                "basicConnection": "b2582db9-2bd7-4a35-94a3-fbbade0a581d",
                "apiKeyAuthKeyConnection": "",
                "apiKeyXKeyConnection": "",
                "oAuth2Connection": "",
                "async": false,
                "cache": false,
                "cacheExpiry": 0,
                "timeout": 8000,
                "retryAttempts": 0,
                "storeResponseHeaders": false,
                "allowSelfSigned": false,
                "errorLogging": "none",
                "debugLogging": "none",
                "abortOnError": false,
                "logWarning": ""
            },
            "preview": "{{cc.constants.serviceNowApi.baseUrls.appointments}}?sysparm_query=patient={{cc.sessionInfo.patient.sysId}}",
            "localeReference": "6873f7f242ec168c188334ee"
        }
    },
    {
        "node": "69061f6345fdac4d5c8183ca",
        "children": [],
        "next": null,
        "_id": "69061f6345fdac4d5c8183cc",
        "_data": {
            "_id": "69061f6345fdac4d5c8183ca",
            "referenceId": "6bbb6f3d-517b-48d5-801c-2fa98b26d773",
            "type": "code",
            "extension": "@cognigy/basic-nodes",
            "label": "C: Process response (2)",
            "comment": "",
            "commentColor": "",
            "analyticsLabel": null,
            "isEntryPoint": false,
            "isDisabled": false,
            "config": {
                "code": "try {\r\n\r\n    function processAppointmentResponse(respone) {\r\n        let memory = {};\r\n        let rtaText = {};\r\n\r\n        if (respone.statusCode != 200) {\r\n            cc.sessionInfo.appointments.failed = true;\r\n            rtaText = \"The patient was found. Getting all appointments failed.\"\r\n            return\r\n        }\r\n\r\n        let content = respone.result.result;\r\n        if (content.length > 0) {\r\n            cc.sessionInfo.appointments.all = content;\r\n            memory = cc.sessionInfo.appointments;\r\n            rtaText = `Getting all appointments succeeded. The user currently has ${content.length.toString()} appointments. Go on with the process the patient wanted.`\r\n        } else {\r\n            rtaText = \"The patient currently does not have any appointments\"\r\n        }\r\n\r\n        cc.sessionInfo.aiAgent.shortTermMemory.appointments = memory;\r\n        cc.sessionInfo.appointments.rtaText = rtaText;\r\n    }\r\n\r\n    processAppointmentResponse(ci.httprequest);\r\n\r\n    \r\n} catch(err) {\r\n    api.log(\"error\", `Error in cleaning get all appointments response. Error was: ${err.toString()}`)\r\n}",
                "hasError": false,
                "transpiled": "try {\n    function processAppointmentResponse(respone) {\n        let memory = {};\n        let rtaText = {};\n        if (respone.statusCode != 200) {\n            cc.sessionInfo.appointments.failed = true;\n            rtaText = \"The patient was found. Getting all appointments failed.\";\n            return;\n        }\n        let content = respone.result.result;\n        if (content.length > 0) {\n            cc.sessionInfo.appointments.all = content;\n            memory = cc.sessionInfo.appointments;\n            rtaText = `Getting all appointments succeeded. The user currently has ${content.length.toString()} appointments. Go on with the process the patient wanted.`;\n        }\n        else {\n            rtaText = \"The patient currently does not have any appointments\";\n        }\n        cc.sessionInfo.aiAgent.shortTermMemory.appointments = memory;\n        cc.sessionInfo.appointments.rtaText = rtaText;\n    }\n    processAppointmentResponse(ci.httprequest);\n}\ncatch (err) {\n    api.log(\"error\", `Error in cleaning get all appointments response. Error was: ${err.toString()}`);\n}\n"
            },
            "preview": "",
            "localeReference": "6873f7f242ec168c188334ee"
        }
    },
    {
        "node": "69061f6345fdac4d5c8183c1",
        "children": [],
        "next": "69061f6345fdac4d5c8183c8",
        "_id": "69061f6345fdac4d5c8183cd",
        "_data": {
            "_id": "69061f6345fdac4d5c8183c1",
            "referenceId": "9703d62f-455b-4c93-8835-fcd5ac70be4b",
            "type": "executeFlow",
            "extension": "@cognigy/basic-nodes",
            "label": "EX: Get Use Id",
            "comment": "",
            "commentColor": "",
            "analyticsLabel": null,
            "isEntryPoint": false,
            "isDisabled": false,
            "config": {
                "flowNode": {
                    "flow": "817faca8-f573-4fcb-a4f9-f095d0b506a9",
                    "node": "0b083e7a-2f05-4f94-ad27-04d3932411c5"
                },
                "parseIntents": true,
                "parseKeyphrases": true,
                "absorbContext": ""
            },
            "preview": {
                "flow": "817faca8-f573-4fcb-a4f9-f095d0b506a9",
                "node": "0b083e7a-2f05-4f94-ad27-04d3932411c5"
            },
            "localeReference": "6873f7f242ec168c188334ee"
        }
    }
]